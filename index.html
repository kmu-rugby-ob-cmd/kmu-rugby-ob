<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>関西医科大学ラグビー部OB会</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- ===== パスワードゲート ===== -->
<div id="gate" class="gate">
  <div class="gate__card">
    <h2>会員専用ページ</h2>
    <p class="muted">
      このページはOB会会員向けです。<br>
      合言葉（パスワード）を入力してください。<br>
      ※ 一度入力すると <strong>24時間</strong> は再入力不要です。
    </p>

    <div class="gate__row">
      <input id="pw" type="password" placeholder="パスワード">
      <button id="pwBtn" class="btn">入室</button>
    </div>

    <p id="pwErr" class="error"></p>
  </div>
</div>

<!-- ===== ヘッダー ===== -->
<header class="topbar">
  <div class="wrap topbar__inner">
    <div class="brand">
      <div class="brand__badge">KMU</div>
      <div class="brand__text">
        <div class="brand__title">関西医科大学ラグビー部OB会</div>
        <div class="brand__subtitle">Kansai Medical University Rugby Club</div>
      </div>
    </div>

    <nav class="nav">
      <a href="accounting.html" class="nav__link nav__link--strong">年次会計報告</a>
      <a href="#contact" class="nav__link">連絡先登録</a>
      <a href="#news" class="nav__link">お知らせ</a>
      <a href="#schedule" class="nav__link">予定表</a>
      <a href="magazine.html" class="nav__link">部誌</a>
    </nav>
  </div>
</header>

<!-- ===== メイン ===== -->
<main class="wrap">

  <section class="hero">
    <h1>関西医科大学ラグビー部OB会</h1>
    <p class="muted">
      OB会からのご案内、活動予定、部誌、会計報告をまとめた公式サイトです。
    </p>
  </section>

  <section id="contact" class="section">
    <h2>連絡先の確認・登録</h2>
    <a class="btn"
       target="_blank"
       href="https://docs.google.com/forms/d/e/1FAIpQLSeCmVJEP1rfuQdIvcYm5URyk_26z0yZFeivVwO6i3mG4ubHJA/viewform?usp=publish-editor">
      連絡先登録フォームを開く
    </a>
  </section>

  <section id="news" class="section">
    <h2>お知らせ</h2>
    <div class="embed">
      <iframe
        src="https://docs.google.com/spreadsheets/d/e/2PACX-1vT2CNdb3UMpKUIb5k-WElzt-iv8sBftYOga0gkMO6jgciZNJNfLwVee0T2u8MajPtfjxQ22ESKh45Xi/pubhtml?gid=0&single=true">
      </iframe>
    </div>
  </section>

  <section id="schedule" class="section">
    <h2>活動予定</h2>
    <div class="embed embed--calendar">
      <iframe
        src="https://calendar.google.com/calendar/embed?src=kmu.rugby.ob%40gmail.com&ctz=Asia%2FTokyo">
      </iframe>
    </div>
  </section>

</main>

<footer class="footer">
  関西医科大学ラグビー部OB会
</footer>

<!-- ===== スクリプト ===== -->
<script>
  const SITE_PASSWORD = "kmu-rugby-makino"; // ←必ず変更
  const KEY = "kmu_ob_gate";
  const DAY = 24 * 60 * 60 * 1000;

  const gate = document.getElementById("gate");
  const pw = document.getElementById("pw");
  const btn = document.getElementById("pwBtn");
  const err = document.getElementById("pwErr");

  function allow() {
    return Number(localStorage.getItem(KEY)) > Date.now();
  }

  function openSite() {
    gate.classList.add("hidden");
    document.body.classList.remove("locked");
  }

  function lockSite() {
    gate.classList.remove("hidden");
    document.body.classList.add("locked");
  }

  btn.onclick = () => {
    if (pw.value === SITE_PASSWORD) {
      localStorage.setItem(KEY, Date.now() + DAY);
      openSite();
    } else {
      err.textContent = "パスワードが違います。";
    }
  };

  // 初期化（ここが超重要）
  if (allow()) {
    openSite();
  } else {
    lockSite();
  }
</script>

</body>
</html>

